<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ player.player_name }} - LR2IR Player Profile</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>LR2IR Player Profile</h1>
            <div class="search-bar">
                <form action="/search" method="POST" style="display: inline;">
                    <input type="text" name="player_id" placeholder="プレイヤーIDを入力" />
                    <button type="submit">検索</button>
                </form>
            </div>
        </header>

        <main class="content">
            <!-- プレイヤー基本情報 -->
            <section class="player-info">
                <h2>{{ player.player_name }}</h2>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="label">LR2ID:</span>
                        <span class="value">{{ player.lr2_id }}</span>
                    </div>
                    <div class="info-item">
                        <span class="label">段位認定:</span>
                        <span class="value">{{ player.rank }}</span>
                    </div>
                </div>

                <div class="section">
                    <h3>自己紹介</h3>
                    <p class="introduction">
                        {% if player.introduction %}
                            {{ player.introduction }}
                        {% else %}
                            紹介文がまだ設定されていません
                        {% endif %}
                    </p>
                </div>

                {% if player.homepage %}
                <div class="section">
                    <h3>ホームページ</h3>
                    <a href="{{ player.homepage.url }}" target="_blank" class="homepage-link">
                        {{ player.homepage.text }}
                    </a>
                </div>
                {% endif %}
            </section>

            <!-- プレイ統計 -->
            <section class="statistics">
                <h2>プレイ統計</h2>
                <div class="stat-grid">
                    <div class="stat-item">
                        <span class="stat-label">プレイした曲数</span>
                        <span class="stat-value">{{ player.played_charts }}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">プレイした回数</span>
                        <span class="stat-value">{{ player.play_count }}</span>
                    </div>
                </div>

                {% if player.clear_stats %}
                <div class="section">
                    <h3>クリア曲数</h3>
                    <table class="clear-stats-table">
                        <thead>
                            <tr>
                                <th>FULLCOMBO</th>
                                <th>HARD</th>
                                <th>NORMAL</th>
                                <th>EASY</th>
                                <th>FAILED</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                {% for key in ['FULLCOMBO', 'HARD', 'NORMAL', 'EASY', 'FAILED'] %}
                                <td>{{ player.clear_stats.get(key, '-') }}</td>
                                {% endfor %}
                            </tr>
                        </tbody>
                    </table>
                </div>
                {% endif %}
            </section>

            <!-- ライバル -->
            {% if player.rivals %}
            <section class="rivals">
                <h2>ライバル ({{ player.rivals|length }}人)</h2>
                <div class="rival-list">
                    {% for rival in player.rivals %}
                    <span class="rival-tag">{{ rival }}</span>
                    {% endfor %}
                </div>
            </section>
            {% endif %}

            <!-- よくプレイする曲 -->
            {% if player.favorite_songs %}
            <section class="songs">
                <h2>よくプレイする曲 Top 10</h2>
                <table class="songs-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>タイトル</th>
                            <th>クリア</th>
                            <th>プレイ回数</th>
                            <th>ランキング</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for song in player.favorite_songs %}
                        <tr class="clear-{{ song.clear.replace(' ', '').lower() }}">
                            <td class="rank">{{ song.rank }}</td>
                            <td class="title">{{ song.title }}</td>
                            <td class="clear">{{ song.clear }}</td>
                            <td class="play-count">{{ song.play_count }}</td>
                            <td class="ranking">{{ song.ranking }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </section>
            {% endif %}

            <!-- 最近プレイした曲 -->
            {% if player.recent_songs %}
            <section class="songs">
                <h2>最近プレイした曲</h2>
                <table class="songs-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>タイトル</th>
                            <th>クリア</th>
                            <th>プレイ回数</th>
                            <th>ランキング</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for song in player.recent_songs %}
                        <tr class="clear-{{ song.clear.replace(' ', '').lower() }}">
                            <td class="rank">{{ song.rank }}</td>
                            <td class="title">{{ song.title }}</td>
                            <td class="clear">{{ song.clear }}</td>
                            <td class="play-count">{{ song.play_count }}</td>
                            <td class="ranking">{{ song.ranking }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </section>
            {% endif %}

            <!-- 最近プレイしたコース -->
            {% if player.recent_courses %}
            <section class="courses">
                <h2>最近プレイしたコース</h2>
                <table class="songs-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>タイトル</th>
                            <th>クリア</th>
                            <th>プレイ回数</th>
                            <th>ランキング</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for course in player.recent_courses %}
                        <tr class="clear-{{ course.clear.replace(' ', '').lower() }}">
                            <td class="rank">{{ course.rank }}</td>
                            <td class="title">{{ course.title }}</td>
                            <td class="clear">{{ course.clear }}</td>
                            <td class="play-count">{{ course.play_count }}</td>
                            <td class="ranking">{{ course.ranking }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </section>
            {% endif %}

            <!-- 一行BBS -->
            {% if player.bbs_comments %}
            <section class="bbs">
                <h2>一行BBS</h2>
                <div class="bbs-comments">
                    {% for comment in player.bbs_comments %}
                    <div class="bbs-comment">
                        <span class="comment-player"><strong>{{ comment.player }}</strong></span>
                        <span class="comment-date">[{{ comment.date }}]</span>
                        <p class="comment-text">{{ comment.text }}</p>
                    </div>
                    {% endfor %}
                </div>
            </section>
            {% endif %}
        </main>

        <footer>
            <p>LR2IR Player Profile Display &copy; 2026</p>
        </footer>
    </div>
</body>
</html>
